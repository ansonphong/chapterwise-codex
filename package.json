{
  "name": "chapterwise-codex",
  "displayName": "ChapterWise Codex",
  "description": "Codex file format Manuscript editing with tree navigation, distraction-free prose editing, and format validation.",
  "version": "0.2.0",
  "publisher": "StudioPhong",
  "icon": "media/icon.png",
  "repository": {
    "type": "git",
    "url": "https://github.com/chapterwise/chapterwise-codex"
  },
  "engines": {
    "vscode": "^1.80.0"
  },
  "categories": [
    "Other",
    "Formatters"
  ],
  "keywords": [
    "codex",
    "yaml",
    "writing",
    "storytelling",
    "worldbuilding"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "chapterwiseCodex.openNavigator",
        "title": "ChapterWise Codex: Open Navigator"
      },
      {
        "command": "chapterwiseCodex.filterByType",
        "title": "ChapterWise Codex: Filter Nodes by Type",
        "icon": "$(filter)"
      },
      {
        "command": "chapterwiseCodex.openWriterView",
        "title": "ChapterWise Codex: Open Writer View",
        "icon": "$(edit)"
      },
      {
        "command": "chapterwiseCodex.refresh",
        "title": "ChapterWise Codex: Refresh Tree",
        "icon": "$(refresh)"
      },
      {
        "command": "chapterwiseCodex.goToYaml",
        "title": "Go to YAML/JSON"
      },
      {
        "command": "chapterwiseCodex.copyId",
        "title": "Copy ID"
      },
      {
        "command": "chapterwiseCodex.toggleFields",
        "title": "ChapterWise Codex: Toggle Field Display",
        "icon": "$(list-tree)"
      },
      {
        "command": "chapterwiseCodex.autoFix",
        "title": "ChapterWise Codex: Auto-Fix Document",
        "icon": "$(wand)"
      },
      {
        "command": "chapterwiseCodex.autoFixRegenIds",
        "title": "ChapterWise Codex: Auto-Fix (Regenerate All IDs)",
        "icon": "$(sync)"
      },
      {
        "command": "chapterwiseCodex.explodeCodex",
        "title": "ChapterWise Codex: Explode Codex (Extract Children to Files)"
      },
      {
        "command": "chapterwiseCodex.implodeCodex",
        "title": "ChapterWise Codex: Implode Codex (Merge Included Files)"
      },
      {
        "command": "chapterwiseCodex.updateWordCount",
        "title": "ChapterWise Codex: Update Word Count"
      },
      {
        "command": "chapterwiseCodex.generateTags",
        "title": "ChapterWise Codex: Generate Tags"
      },
      {
        "command": "chapterwiseCodex.generateIndex",
        "title": "ChapterWise Codex: Generate Index",
        "icon": "$(file-add)"
      },
      {
        "command": "chapterwiseCodex.regenerateIndex",
        "title": "ChapterWise Codex: Regenerate Index",
        "icon": "$(sync)"
      },
      {
        "command": "chapterwiseCodex.createIndexFile",
        "title": "ChapterWise Codex: Create Index File",
        "icon": "$(new-file)"
      },
      {
        "command": "chapterwiseCodex.convertToMarkdown",
        "title": "ChapterWise Codex: Convert to Markdown (Codex Lite)"
      },
      {
        "command": "chapterwiseCodex.convertToCodex",
        "title": "ChapterWise Codex: Convert Markdown to Codex"
      },
      {
        "command": "chapterwiseCodex.addChildNode",
        "title": "Add Child Node",
        "icon": "$(add)"
      },
      {
        "command": "chapterwiseCodex.addSiblingNode",
        "title": "Add Sibling Node"
      },
      {
        "command": "chapterwiseCodex.removeNode",
        "title": "Remove from Tree",
        "icon": "$(trash)"
      },
      {
        "command": "chapterwiseCodex.deleteNodePermanently",
        "title": "Delete Node Permanently"
      },
      {
        "command": "chapterwiseCodex.renameNode",
        "title": "Rename Node",
        "icon": "$(edit)"
      },
      {
        "command": "chapterwiseCodex.moveNodeUp",
        "title": "Move Node Up"
      },
      {
        "command": "chapterwiseCodex.moveNodeDown",
        "title": "Move Node Down"
      },
      {
        "command": "chapterwiseCodex.changeColor",
        "title": "Change Color",
        "icon": "$(symbol-color)"
      },
      {
        "command": "chapterwiseCodex.switchToIndexMode",
        "title": "Show Index View",
        "icon": "$(list-tree)"
      },
      {
        "command": "chapterwiseCodex.autofixFolder",
        "title": "Autofix Folder",
        "icon": "$(wand)"
      },
      {
        "command": "chapterwiseCodex.setContextFolder",
        "title": "Set as Codex Context Folder",
        "icon": "$(folder-active)"
      },
      {
        "command": "chapterwiseCodex.setContextFile",
        "title": "Set as Codex Context File",
        "icon": "$(file-code)"
      },
      {
        "command": "chapterwiseCodex.resetContext",
        "title": "Reset to Workspace Root",
        "icon": "$(home)"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "chapterwiseCodex",
          "title": "ChapterWise Codex",
          "icon": "media/codex-v4.svg"
        }
      ]
    },
    "views": {
      "chapterwiseCodex": [
        {
          "id": "chapterwiseCodexNavigator",
          "name": "ChapterWise Codex Navigator"
        }
      ]
    },
    "viewsWelcome": [
      {
        "view": "chapterwiseCodexNavigator",
        "contents": "No Codex file is currently open.\n\nOpen a .codex.yaml or .codex.json file to see its structure here.\n\n[Open Codex File](command:workbench.action.files.openFile)"
      }
    ],
    "menus": {
      "explorer/context": [
        {
          "command": "chapterwiseCodex.setContextFolder",
          "when": "explorerResourceIsFolder",
          "group": "2_workspace@1"
        },
        {
          "command": "chapterwiseCodex.setContextFile",
          "when": "resourceExtname == .yaml && resourceFilename =~ /\\.codex\\.yaml$/",
          "group": "2_workspace@2"
        }
      ],
      "editor/title": [
        {
          "command": "chapterwiseCodex.autoFix",
          "when": "resourceFilename =~ /\\.codex\\.(yaml|json)$/ || resourceFilename =~ /\\.codex$/",
          "group": "navigation"
        }
      ],
      "editor/title/context": [
        {
          "command": "chapterwiseCodex.autoFix",
          "when": "resourceFilename =~ /\\.codex\\.(yaml|json)$/ || resourceFilename =~ /\\.codex$/",
          "group": "codex@1"
        },
        {
          "command": "chapterwiseCodex.autoFixRegenIds",
          "when": "resourceFilename =~ /\\.codex\\.(yaml|json)$/ || resourceFilename =~ /\\.codex$/",
          "group": "codex@2"
        }
      ],
      "editor/context": [
        {
          "command": "chapterwiseCodex.autoFix",
          "when": "resourceFilename =~ /\\.codex\\.(yaml|json)$/ || resourceFilename =~ /\\.codex$/",
          "group": "codex"
        }
      ],
      "view/title": [
        {
          "command": "chapterwiseCodex.autoFix",
          "when": "view == chapterwiseCodexNavigator",
          "group": "navigation@1"
        },
        {
          "command": "chapterwiseCodex.filterByType",
          "when": "view == chapterwiseCodexNavigator",
          "group": "navigation@2"
        },
        {
          "command": "chapterwiseCodex.refresh",
          "when": "view == chapterwiseCodexNavigator",
          "group": "navigation@3"
        }
      ],
      "view/item/context": [
        {
          "command": "chapterwiseCodex.openWriterView",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "inline"
        },
        {
          "command": "chapterwiseCodex.addChildNode",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "1_add@1"
        },
        {
          "command": "chapterwiseCodex.addSiblingNode",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "1_add@2"
        },
        {
          "command": "chapterwiseCodex.renameNode",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "2_edit@1"
        },
        {
          "command": "chapterwiseCodex.changeColor",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "2_edit@2"
        },
        {
          "command": "chapterwiseCodex.moveNodeUp",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "3_move@1"
        },
        {
          "command": "chapterwiseCodex.moveNodeDown",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "3_move@2"
        },
        {
          "command": "chapterwiseCodex.goToYaml",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "4_navigate@1"
        },
        {
          "command": "chapterwiseCodex.copyId",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "4_navigate@2"
        },
        {
          "command": "chapterwiseCodex.removeNode",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "5_delete@1"
        },
        {
          "command": "chapterwiseCodex.deleteNodePermanently",
          "when": "view == chapterwiseCodexNavigator && viewItem == codexNode",
          "group": "5_delete@2"
        },
        {
          "command": "chapterwiseCodex.autofixFolder",
          "when": "view == chapterwiseCodexNavigator && viewItem == indexFolder",
          "group": "2_edit@3"
        }
      ],
      "commandPalette": [
        {
          "command": "chapterwiseCodex.createIndexFile",
          "when": "workspaceFolderCount > 0"
        },
        {
          "command": "chapterwiseCodex.generateIndex",
          "when": "workspaceFolderCount > 0"
        },
        {
          "command": "chapterwiseCodex.regenerateIndex",
          "when": "workspaceFolderCount > 0"
        }
      ]
    },
    "keybindings": [
      {
        "command": "chapterwiseCodex.openWriterView",
        "key": "ctrl+shift+w",
        "mac": "cmd+shift+w",
        "when": "editorTextFocus && resourceFilename =~ /\\.codex\\.(yaml|json)$/"
      },
      {
        "command": "workbench.view.extension.chapterwiseCodex",
        "key": "ctrl+shift+e",
        "mac": "cmd+shift+e",
        "when": "resourceFilename =~ /\\.codex\\.(yaml|json)$/"
      },
      {
        "command": "chapterwiseCodex.addChildNode",
        "key": "ctrl+shift+n",
        "mac": "cmd+shift+n",
        "when": "focusedView == chapterwiseCodexNavigator"
      },
      {
        "command": "chapterwiseCodex.changeColor",
        "key": "ctrl+shift+c",
        "mac": "cmd+shift+c",
        "when": "focusedView == chapterwiseCodexNavigator"
      },
      {
        "command": "chapterwiseCodex.removeNode",
        "key": "delete",
        "mac": "delete",
        "when": "focusedView == chapterwiseCodexNavigator"
      },
      {
        "command": "chapterwiseCodex.deleteNodePermanently",
        "key": "shift+delete",
        "mac": "shift+delete",
        "when": "focusedView == chapterwiseCodexNavigator"
      },
      {
        "command": "chapterwiseCodex.moveNodeUp",
        "key": "ctrl+up",
        "mac": "cmd+up",
        "when": "focusedView == chapterwiseCodexNavigator"
      },
      {
        "command": "chapterwiseCodex.moveNodeDown",
        "key": "ctrl+down",
        "mac": "cmd+down",
        "when": "focusedView == chapterwiseCodexNavigator"
      }
    ],
    "snippets": [
      {
        "language": "yaml",
        "path": "./snippets/codex.code-snippets"
      }
    ],
    "languages": [
      {
        "id": "yaml",
        "extensions": [
          ".codex.yaml",
          ".codex"
        ]
      },
      {
        "id": "json",
        "extensions": [
          ".codex.json"
        ]
      }
    ],
    "configuration": {
      "title": "ChapterWise Codex",
      "properties": {
        "chapterwiseCodex.showFieldsInTree": {
          "type": "boolean",
          "default": true,
          "description": "Show field entries (body, summary, attributes, content) as expandable children under nodes in the Codex Navigator tree"
        },
        "chapterwiseCodex.navigator.defaultChildMode": {
          "type": "string",
          "enum": ["inline", "separate-file", "ask"],
          "default": "ask",
          "description": "How to create new child nodes: inline (in same file), separate-file (new file), or ask (prompt each time)"
        },
        "chapterwiseCodex.navigator.fileOrganization.strategy": {
          "type": "string",
          "enum": ["organized", "data-folder", "flat"],
          "default": "organized",
          "description": "File organization strategy: organized (hierarchical folders), data-folder (Scrivener-style UUID storage), or flat (same directory)"
        },
        "chapterwiseCodex.navigator.fileOrganization.dataFolderPath": {
          "type": "string",
          "default": "Files/Data",
          "description": "Path for data-folder strategy (relative to workspace root)"
        },
        "chapterwiseCodex.navigator.fileOrganization.useUuidFilenames": {
          "type": "boolean",
          "default": false,
          "description": "Use UUID filenames instead of name-based filenames"
        },
        "chapterwiseCodex.navigator.naming.slugify": {
          "type": "boolean",
          "default": true,
          "description": "Convert node names to URL-friendly slugs (e.g., 'Chapter 1' â†’ 'chapter-01')"
        },
        "chapterwiseCodex.navigator.naming.separator": {
          "type": "string",
          "default": "-",
          "description": "Separator character for slugified names"
        },
        "chapterwiseCodex.navigator.naming.includeType": {
          "type": "boolean",
          "default": false,
          "description": "Include type prefix in filename (e.g., 'character-aya.yaml')"
        },
        "chapterwiseCodex.navigator.automation.autoSave": {
          "type": "boolean",
          "default": true,
          "description": "Automatically save files after structural changes"
        },
        "chapterwiseCodex.navigator.automation.autoGenerateIds": {
          "type": "boolean",
          "default": true,
          "description": "Automatically generate UUIDs for new nodes"
        },
        "chapterwiseCodex.navigator.automation.autoGenerateIndex": {
          "type": "boolean",
          "default": true,
          "description": "Automatically regenerate index after file operations"
        },
        "chapterwiseCodex.navigator.safety.confirmDelete": {
          "type": "boolean",
          "default": true,
          "description": "Show confirmation dialog before deleting nodes"
        },
        "chapterwiseCodex.navigator.safety.backupBeforeDestruct": {
          "type": "boolean",
          "default": true,
          "description": "Create backup before permanent deletion"
        },
        "chapterwiseCodex.navigator.colors.inheritFromParent": {
          "type": "boolean",
          "default": false,
          "description": "Children inherit parent node colors if not explicitly set"
        },
        "chapterwiseCodex.navigator.colors.showInheritedDimmed": {
          "type": "boolean",
          "default": true,
          "description": "Show inherited colors with reduced opacity"
        },
        "chapterwiseCodex.writerView.theme": {
          "type": "string",
          "enum": ["light", "dark", "system", "theme"],
          "default": "theme",
          "enumDescriptions": [
            "Always use light theme",
            "Always use dark theme",
            "Follow your operating system's light/dark mode setting",
            "Adapt to your current VS Code theme colors"
          ],
          "description": "Color theme for the Writer View prose editor"
        }
      }
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "node esbuild.js --production",
    "watch": "node esbuild.js --watch",
    "compile:tsc": "tsc -p ./",
    "pretest": "npm run compile",
    "lint": "eslint src --ext ts",
    "package": "vsce package"
  },
  "dependencies": {
    "minimatch": "^9.0.0",
    "yaml": "^2.5.0"
  },
  "devDependencies": {
    "@types/minimatch": "^5.1.0",
    "@types/node": "^20.10.0",
    "@types/vscode": "^1.80.0",
    "@vscode/vsce": "^2.22.0",
    "esbuild": "^0.20.2",
    "typescript": "^5.4.0"
  }
}
